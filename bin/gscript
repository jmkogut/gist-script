#!/usr/bin/env ruby

# Insert CLI tool codes here.

require 'rubygems'
require 'Octokit'
require 'highline/import'
require 'netrc'



unless (ARGV.length == 1) || (ARGV.length == 2)
	puts "Incorrect number of arguments"
	exit
end

def auth(username)

	password = get_password()

	client = Octokit::Client.new \
 	:login    => username,
 	:password => password

 	begin
 		user = client.user
 		user.login
 	rescue
 		puts "could not authorize your credentials!"
 		puts "either your username or password is incorrect,"
 		puts "you are not connected to the internet, or github is down"
 		
 		exit
 	end
	
	n = Netrc.read
 	n["Github.com"] = username, password
 	n.save
end


def get_password(prompt="Enter Password:")
   	ask(prompt) {|q| q.echo = false}
end


if (ARGV[0] == 'auth') && (ARGV.length == 2)
	auth(ARGV[1])
end
